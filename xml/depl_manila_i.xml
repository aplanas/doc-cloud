<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1
[
  <!ENTITY % entities SYSTEM "entity-decl.ent">
  %entities;
]>
<!-- Converted by suse-upgrade version 1.1 -->
<sect1 xmlns="http://docbook.org/ns/docbook"
       xmlns:xi="http://www.w3.org/2001/XInclude"
       xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0"
       xml:id="sec.depl.ostack.manila">

  <title>Deploying &o_sharefs;</title>
  <para>
   &o_sharefs; provides coordinated access to shared or distributed file
   systems, similar to what &o_blockstore; does for block storage. These file
   systems can be shared between &vmguest;s in &cloud;.
  </para>
  <para>
   &o_sharefs; uses different back-ends. As of &productname; &productnumber;
   currently supported back-ends include <guimenu>Hitachi HNAS</guimenu>, <guimenu>NetApp
   Driver</guimenu>, and <guimenu>CephFS</guimenu>. Two more back-end options, <guimenu>Generic Driver</guimenu> and <guimenu>Other Driver</guimenu> are available for
   testing purposes and are not supported.
  </para>
  <note xml:id="note.limit.cephfs">
   <title>Limitations for CephFS Backend</title>
   <para>
    &o_sharefs; uses some CephFS features that are currently <emphasis>not</emphasis>
    supported by the &sle; 12 SP2 CephFS kernel client:
   </para>
   <itemizedlist>
    <listitem>
     <para>
      RADOS namespaces
     </para>
    </listitem>
    <listitem>
     <para>
      MDS path restrictions
     </para>
    </listitem>
    <listitem>
     <para>
      Quotas
     </para>
    </listitem>
   </itemizedlist>
   <para>
    As a result, to access CephFS shares provisioned by &o_sharefs;, you must
    use ceph-fuse. For details, see <link
    xlink:href="http://docs.openstack.org/developer/manila/devref/cephfs_native_driver.html"/>.
    </para>
   </note>
  <para>
   When first opening the &o_sharefs; &barcl;, the default proposal
   <guimenu>Generic Driver</guimenu> is already available for
   configuration. To replace it, first delete it by clicking the trashcan
   icon and then choose a different back-end in the section <guimenu>Add new
   Manila Backend</guimenu>. Select a <guimenu>Type of Share</guimenu>
   and&mdash;optionally&mdash;provide a <guimenu>Name for
   Backend</guimenu>. Activate the back-end with <guimenu>Add
   Backend</guimenu>. Note that at least one back-end must be configured.
  </para>
  <para>
   The attributes that can be set to configure Cinder depend on the back-end:
  </para>

  <bridgehead renderas="sect2"><guimenu>Back-end: Generic</guimenu>
  </bridgehead>

  <para>
   The generic driver is included as a technology preview and is not
   supported.
  </para>

  <bridgehead renderas="sect2"><guimenu>Hitachi HNAS</guimenu>
  </bridgehead>

  <variablelist>
   <varlistentry>
    <term>
     <guimenu>Specify which EVS this backend is assigned to</guimenu>
    </term>
    <listitem>
     <para>
      Provide the name of the Enterprise Virtual Server that the selected back-end is assigned to.<remark condition="accuracy">2017-01-03 - dpopov: DEVS FIXME Please check whether this is correct.</remark>
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>
     <guimenu>Specify IP for mounting shares</guimenu>
    </term>
    <listitem>
     <para>
      IP address for mounting shares.<remark condition="info">2017-01-03 - dpopov: DEVS FIXME More info needed.</remark>
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>
     <guimenu>Specify file-system name for creating shares</guimenu>
    </term>
    <listitem>
     <para>
      Provide a file-system name for creating shares.<remark condition="info">2017-01-03 - dpopov: DEVS FIXME More info needed.</remark>
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>
     <guimenu>HNAS management interface IP</guimenu>
    </term>
    <listitem>
     <para>
      IP address of the HNAS management interface for communication between Manila controller and HNAS.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>
     <guimenu>HNAS username Base64 String</guimenu>
    </term>
    <listitem>
     <para>
      HNAS username Base64 String required to perform tasks like creating file-systems and network interfaces.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>
     <guimenu>HNAS user password</guimenu>
    </term>
    <listitem>
     <para>
      HNAS user password. Required only if private key is not provided.<remark condition="accuracy">2017-01-03 - dpopov: DEVS FIXME Please check whether this is correct.</remark>
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>
     <guimenu>RSA/DSA private key</guimenu>
    </term>
    <listitem>
     <para>
      RSA/DSA private key necessary for connecting to HNAS. Required only if password is not provided.<remark condition="accuracy">2017-01-03 - dpopov: DEVS FIXME Please check whether this is correct.</remark>
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>
     <guimenu>The time to wait for stalled HNAS jobs before aborting</guimenu>
    </term>
    <listitem>
     <para>
      Time in seconds to wait before aborting stalled HNAS jobs.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>

  <bridgehead renderas="sect2"><guimenu>Back-end: Netapp</guimenu>
  </bridgehead>

  <variablelist>
   <varlistentry>
    <term>
     <guimenu>Name of the Virtual Storage Server (vserver)</guimenu>
    </term>
    <listitem>
     <para>
      Host name of the Virtual Storage Server.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><guimenu>Server Host Name</guimenu></term>
    <listitem>
     <para>
      The name or IP address for the storage controller or the cluster.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><guimenu>Server Port</guimenu></term>
    <listitem>
     <para>
      The port to use for communication. Port 80 is usually used for HTTP, 443
      for HTTPS.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><guimenu>User name/Password for Accessing NetApp</guimenu></term>
    <listitem>
     <para>
      Login credentials.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><guimenu>Transport Type</guimenu></term>
    <listitem>
     <para>
      Transport protocol for communicating with the storage controller or
      cluster. Supported protocols are HTTP and HTTPS. Choose the protocol
      your NetApp is licensed for.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>

  <bridgehead renderas="sect2"><guimenu>Back-end: CephFS</guimenu>
  </bridgehead>

  <variablelist>
    <varlistentry>
      <term>Use Ceph deployed by Crowbar</term>
      <listitem>
        <para>
          Set to <systemitem>true</systemitem> to use Ceph deployed with Crowbar.
        </para>
      </listitem>
    </varlistentry>
  </variablelist>

  <bridgehead renderas="sect2"><guimenu>Back-end: Manual</guimenu>
  </bridgehead>

  <para>
   Lets you manually pick and configure a driver. Only use this option for
   testing purposes, it is not supported.
  </para>

  <figure>
   <title>The &o_sharefs; &Barcl;</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="depl_barclamp_manila.png" width="100%" format="png"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="depl_barclamp_manila.png" width="75%" format="png"/>
    </imageobject>
   </mediaobject>
  </figure>

  <para>
   The &o_sharefs; component consists of two different roles:
  </para>

  <variablelist>
   <varlistentry>
    <term><guimenu>manila-server</guimenu>
    </term>
    <listitem>
     <para>
      The &o_sharefs; server provides the scheduler and the API. Installing it
      on a &contrnode; is recommended.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><guimenu>manila-share</guimenu>
    </term>
    <listitem>
     <para>
      The shared storage service. It can be installed on a &contrnode;, but
      it is recommended to deploy it on one or more dedicated nodes supplied
      with sufficient disk space and networking capacity, since it will
      generate a lot of network traffic.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>

  <figure>
   <title>The &o_sharefs; &Barcl;: Node Deployment Example</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="depl_barclamp_manila_node_deployment.png" width="100%" format="png"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="depl_barclamp_manila_node_deployment.png" width="75%" format="png"/>
    </imageobject>
   </mediaobject>
  </figure>

  <sect2 xml:id="sec.depl.ostack.manila.ha">
   <title>&haSetup; for &o_sharefs;</title>
   <para>
    While the <guimenu>manila-server</guimenu> role can be deployed on a
    cluster, deploying <guimenu>manila-share</guimenu> on a cluster is not
    supported. Therefore it is generally recommended to deploy
    <guimenu>manila-share</guimenu> on several nodes&mdash;this ensures the
    service continues to be available even when a node fails.
   </para>
  </sect2>

 </sect1>
